<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
	<script src="https://code.jquery.com/jquery-1.12.4.min.js"></script>
</head>
<script>
    /* 
    https://openweathermap.org/current   //api사이트
    5da980755c49bb363969b9ad694421ac    // apikey
    https://namjackson.tistory.com/27   // 참고블로그
    https://erikflowers.github.io/weather-icons/        // 날씨 아이콘 부트스트랩
    화씨에서 섭씨로( ==  섭씨 = 화씨 -273 )
    */

    window.onload = function () {
        var lat = "37.59856"; // 위도
        var lon = "126.9783";   // 경도
        var apiURI = "https://api.openweathermap.org/data/2.5/weather?lat="+lat+"&lon="+lon+"&appid=" + "5da980755c49bb363969b9ad694421ac"; // 우편번호가 안되서 일단 도시명으로..
       // let city = document.getElementById("city").value;
        let imgURL;
            $.ajax({
            url: apiURI,
            dataType: "json",
            type: "GET",
            async: "false",
            success: function (resp) {
                console.log(resp.weather);
                 
                console.log("현재온도 : " + Math.floor(resp.main.temp - 273.15));
                console.log("현재습도 : " + resp.main.humidity);
                console.log("날씨 : " + resp.weather[0].main);
                console.log("상세날씨설명 : " + resp.weather[0].description);
                console.log("날씨 이미지 : " + resp.weather[0].icon);
                console.log("바람   : " + resp.wind.speed);
                console.log("나라   : " + resp.sys.country);
                console.log("도시이름  : " + resp.name);
                console.log("구름  : " + (resp.clouds.all) + "%");
                imgURL = "/img/weather/" + resp.weather[0].icon + ".png";
                var weatherText;
                if(resp.weather[0].main == "Clear"){
                    weatherText = "맑음"
                } else if(resp.weather[0].main == "Rain"){
                    weatherText = "비"
                } else if(resp.weather[0].main == "Thunderstorm"){
                    weatherText = "천둥번개"
                } else if(resp.weather[0].main == "Clouds"){
                    weatherText = "구름"
                } else if(resp.weather[0].main == "Snow"){
                    weatherText = "눈"
                } else if(resp.weather[0].main == "Drizzle"){
                    weatherText = "이슬비"
                } else if(resp.weather[0].main == "Haze"){
                    weatherText = "안개"
                } else if(resp.weather[0].main == "Mist"){
                    weatherText = "옅은 안개"
                }
                $("#weatherImg").attr("src", imgURL);
                $("#weatherMain").text(weatherText);
                $("#temp").text( Math.floor(resp.main.temp - 273.15) + "℃");
                $("#humidity").text(resp.main.humidity + "%");
            }
        })
        

    }
// 공공포탈 안되네유..
// var url = 'http://apis.data.go.kr/1360000/VilageFcstInfoService/getUltraSrtNcst'; /*URL*/
// var queryParams = '?' + encodeURIComponent('ServiceKey') + '='+'aenOV8jTq15Z%2Bw5z%2Fv%2F%2Bc2bra5Xe7C%2Fkj0Jh5AfQXnvbMiZ%2F8EY3mdUqh0%2F8nxCNLX809Erp41ivPkXwRBqjAQ%3D%3D'; /*Service Key*/
// queryParams += '&' + encodeURIComponent('pageNo') + '=' + encodeURIComponent('1'); /**/
// queryParams += '&' + encodeURIComponent('numOfRows') + '=' + encodeURIComponent('10'); /**/
// queryParams += '&' + encodeURIComponent('dataType') + '=' + encodeURIComponent('JSON'); /**/
// queryParams += '&' + encodeURIComponent('base_date') + '=' + encodeURIComponent('20210414'); /**/
// queryParams += '&' + encodeURIComponent('base_time') + '=' + encodeURIComponent('1100'); /**/
// queryParams += '&' + encodeURIComponent('nx') + '=' + encodeURIComponent('59'); /**/
// queryParams += '&' + encodeURIComponent('ny') + '=' + encodeURIComponent('126'); /**/

// window.onload = function () {
//         var apiURI = url + queryParams; 
//         var imgURL;
//         $.ajax({
//             url: apiURI,
//             //dataType: "json",
//             type: "GET",
//             async: "false",
//             success: function (resp) {
//                 console.log(resp);
              
//             }
//         })

//     }

</script>
<style>
.boxLeft {
    float: left;
    padding-top: 13px;
    width: 50px;
}
#weatherImg{
    width: 45px;
    height: auto;
}
.boxRight {
    float: left;
    font-size: 15px;
    height: 70px;
    padding-top: 10px;
    text-align: center;
}

.boxRight table th, td{
    padding: 0 14px 3px 0;
}
.boxCenter {
    float: left;
    font-size: 25px;
    font-weight: bolder;
    height: 70px;
    padding: 15px;
    text-align: center;
}

</style>
<body>
    <div class="weatherBox">
        <div class="boxLeft">
            <img id="weatherImg" src=""><br>
        </div>
        <div class="boxCenter">
            <span id="weatherMain"></span>
        </div>
        <div class="boxRight">
            <table>
                <tr>
                    <th>온도</th>
                    <th>습도</th>
                </tr>
                <tr>
                    <td id="temp"></td>
                    <td id="humidity"></td>
                </tr>
            </table>
        </div>
        
    </div>
</body>
</html>